# 프로젝트 개요

## NGL Transportation 기업 소개

![NGL Logo](/public/images/NGL_width.png)

NGL Transportation은 2006년부터 운영되어온 종합 물류 서비스 제공업체입니다. 현재 미국 전역에서 화물 운송, 창고 관리, 트럭 운송, 특수 프로젝트 서비스 등을 제공하고 있습니다. 캘리포니아, 애리조나, 텍사스, 조지아주에 설비를 갖추고 있으며, 300대 이상의 트럭과 1000대 이상의 섀시를 보유하고 있습니다. 또한 한국 서울에도 아시아 본부를 두고 있어 글로벌 기업들의 물류 요구를 충족시키고 있습니다.

## 프로젝트 목표

WandaVision YOLO 프로젝트는 CCTV 영상을 활용하여 물류 창고나 항만 출입구에서 컨테이너 트럭의 출입을 자동으로 감지하고, 컨테이너 번호를 인식하여 기록하는 시스템입니다. 이를 통해 NGL Transportation의 물류 관리 효율성을 높이고, 인력에 의존하던 컨테이너 출입 기록을 자동화하여 인적 오류를 줄이고자 합니다. 주요 목표는 다음과 같습니다:

1. CCTV 영상에서 실시간으로 컨테이너 트럭 감지
2. 감지된 컨테이너의 번호 인식 및 기록
3. 시간별 컨테이너 출입 내역 자동 관리
4. 웹 인터페이스를 통한 직관적인 모니터링 시스템 구축

## 프로젝트 과정

### CCTV 영상 수집

프로젝트의 첫 단계로 수십 시간의 CCTV 영상을 분석하여 화질이 좋고 트럭이 지나다니는 장면이 잘 포착된 영상만을 선별했습니다. 

### 모델 학습 이미지 수집

YOLO 모델 파인튜닝을 위해 객체 탐지하고자 하는 컨테이너 트럭이 포함된 다양한 이미지를 수집했습니다. 이미지는 다양한 각도, 조명 조건, 거리에서 촬영되어 모델이 다양한 환경에서도 컨테이너를 정확하게 인식할 수 있도록 했습니다. 이 과정은 Roboflow에서 라벨링을 하기 전 필수적인 준비 단계였습니다.

아래는 수집한 이미지의 예시입니다:

![데이터셋 예시 1](/public/images/dataset_example1.jpg)
![데이터셋 예시 2](/public/images/dataset_example2.jpg)

### RoboFlow에서 모델 학습

프로젝트에서 가장 중요한 단계인 모델 학습은 Roboflow 플랫폼을 활용하여 진행했습니다. 이 과정은 다음과 같은 단계로 이루어졌습니다:

1. **이미지 업로드 및 라벨링**: 수집한 이미지를 Roboflow에 업로드하고, 팀원 4명이 분담하여 컨테이너에 바운딩 박스를 치며 라벨링 작업을 수행했습니다.

   ![Roboflow 라벨링 예시](/public/images/roboflow_labeling_example.png)

2. **데이터셋 구성**: 라벨링이 완료된 이미지들을 모아 완성한 데이터셋은 다음과 같습니다.

   ![Roboflow 데이터셋](/public/images/roboflow_dataset.png)

3. **전처리(Preprocessing)**: YOLO 모델의 입력 형식에 맞게 모든 이미지 크기를 640x640으로 통일했습니다.

4. **데이터 증강(Augmentation)**: 데이터셋의 다양성을 높이기 위해 회전(rotate), 밝기 조절(brightness), 노이즈 추가(noise) 등의 증강 기법을 적용했습니다. 이를 통해 데이터셋의 크기는 원래의 3배로 확장되었습니다.

5. **YOLOv12 모델 파인튜닝**: 최종적으로 완성된 데이터셋을 사용하여 YOLOv12 모델을 파인튜닝했습니다.

   ![파인튜닝 과정](/public/images/fine-tuning_colab.png)

파인튜닝된 모델은 `WandaVisionYOLO.pt` 파일로 저장되어 프로젝트에 포함되었습니다.

### 컨테이너 텍스트 OCR 모델 구성

파인튜닝된 YOLO 모델은 CCTV 동영상에서 트럭 컨테이너가 포함된 영역을 바운딩 박스로 인식합니다. 우리 시스템은 이 바운딩 박스 영역만을 크롭하여 이미지로 저장한 후, Google Gemini AI 모델에 입력합니다. Gemini는 시스템 프롬프트에 따라 OCR을 수행하여 해당 이미지에서 컨테이너 번호만을 추출합니다.

컨테이너 번호는 다음과 같은 표준 형식으로 구성됩니다:

![컨테이너 번호 형식](/public/images/container_number_format.png)

이 형식은 4글자 대문자 + 공백 + 6자리 숫자로 이루어져 있습니다.

### CCTV 영상에서 실시간 컨테이너 이미지 OCR 모델에 입력

영상에서 컨테이너가 감지되면, 해당 영역의 이미지를 추출하여 OCR 모델에 입력합니다. 컨테이너는 프레임 면적의 20% 이상을 차지할 때만 처리하여 원거리의 작은 물체가 잘못 인식되는 것을 방지합니다. 또한 같은 컨테이너가 여러 번 인식되는 것을 방지하기 위해 10초의 캡처 간격을 설정했습니다.

### 시간별 컨테이너 출입 기록 저장

인식된 컨테이너 번호와 시간 정보는 엑셀 파일에 기록됩니다. 이 데이터는 물류 관리자가 컨테이너의 출입 내역을 쉽게 확인하고 관리할 수 있도록 합니다. 인식된 컨테이너 번호가 "UNKNOWN"이나 "ERROR"가 아닌 경우에만 기록됩니다.

## 웹 인터페이스 구현

Next.js와 Tailwind CSS를 사용하여 프로젝트 정보를 사용자들에게 직관적으로 보여주는 웹 인터페이스를 구현했습니다. 웹 인터페이스는 다음과 같은 부분으로 구성되어 있습니다:

1. **메인 페이지**: 시스템의 실시간 모니터링 대시보드를 제공합니다.
2. **프로젝트 개요 페이지**: 프로젝트의 목표, 기업 소개, 그리고 개발 과정을 상세히 설명합니다.

### 웹사이트 구조

프로젝트의 웹사이트는 다음과 같이 구성되어 있습니다:

```
app/
  ├── page.tsx          # 메인 페이지 (모니터링 대시보드)
  ├── about/
  │   └── page.tsx      # 프로젝트 개요 페이지
components/
  ├── Navbar.tsx        # 네비게이션 컴포넌트
  └── dashboard/
      └── Dashboard.tsx # 대시보드 컴포넌트
public/
  └── images/           # 프로젝트 이미지 자료
```

이 구조는 프로젝트의 정보와 기능을 명확하게 분리하여 사용자가 쉽게 접근할 수 있도록 설계되었습니다.
